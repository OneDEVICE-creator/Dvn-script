if not game:IsLoaded() then
    game.Loaded:Wait()
end

local enemyNames = game:GetService("ReplicatedStorage").Units.Noobs:GetChildren()

-- Default values from _G variables
local enemiesHeadSize = _G.EnemiesHeadSize or 8.0
local prometheusHeadSize = _G.PrometheusHeadSize or 2.0
local transparency = _G.Transparency or 0.9

local function EnforceTransparency(head)
    -- Keep monitoring the transparency and reset if it changes
    head:GetPropertyChangedSignal("Transparency"):Connect(function()
        if head.Transparency ~= transparency then
            head.Transparency = transparency
        end
    end)
end

local function ResizeHead(instance)
    if instance.Name == "APU" then
        -- Skip processing for enemies named "APU"
        return
    end

    for _, x in ipairs(enemyNames) do
        if tostring(x) == instance.Name and instance ~= nil then
            -- Wait for the "Head" part to exist
            local head = instance:WaitForChild("Head", 5) -- Wait up to 5 seconds for the Head part
            if head then
                -- Enforce transparency
                head.Transparency = transparency
                EnforceTransparency(head)

                if instance.Name == "Jetpacker" or instance.Name == "Sniper" then
                    head.Size = Vector3.new(5.0, 5.0, 5.0) -- Don't change
                elseif instance.Name == "Prometheus" then
                    head.Size = Vector3.new(prometheusHeadSize, prometheusHeadSize, prometheusHeadSize) -- Prometheus head size
                else
                    head.Size = Vector3.new(enemiesHeadSize, enemiesHeadSize, enemiesHeadSize) -- For other enemies
                end

                -- Additional settings for the head
                head.Massless = true
                head.CanCollide = false -- Disable collisions
            else
                warn("Head not found for instance:", instance.Name)
            end
        end
    end
end

-- Resize heads for all existing enemies
for _, v in ipairs(workspace:GetChildren()) do
    task.wait()
    ResizeHead(v)
end

-- Resize heads for newly added enemies
workspace.ChildAdded:Connect(function(v)
    task.wait()
    ResizeHead(v)
end)

-- Notification when the script is executed
local function executeScript()
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Script Executed",
        Text = "The script has been executed successfully!",
        Duration = 5
    })

    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Have Fun!",
        Text = "Script made by DeathShot",
        Duration = 5
    })
end

-- Call the function to execute the script
executeScript()
